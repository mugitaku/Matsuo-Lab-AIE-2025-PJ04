# 講義質疑応答まとめシステム 設計書

## 1. システム概要

### 目的
大規模講義（最大9000人）における質疑応答を効率化し、講師の負担を軽減しながら受講生の満足度を維持・向上させるシステム

### 主要機能
1. **質問のクラスタリング**: 類似質問を自動的にグループ化
2. **質問の要約**: 複数の質問を統合して要約を生成
3. **回答候補の生成**: AI（Google Gemini）による回答案の作成
4. **リアルタイム処理**: 講義中の即時処理に対応

## 2. システムアーキテクチャ

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  講師用Web UI   │────▶│  Flask Backend  │────▶│ Google Gemini   │
│   (HTML/JS)     │     │   (Python)      │     │     API         │
└─────────────────┘     └─────────────────┘     └─────────────────┘
                               │
                               ▼
                        ┌─────────────────┐
                        │  質問データ     │
                        │  (JSON/CSV)     │
                        └─────────────────┘
```

## 3. 機能詳細

### 3.1 質問のクラスタリング
- **アルゴリズム**: TF-IDFベクトル化 + コサイン類似度
- **閾値**: 類似度0.7以上で同一グループ化
- **最大クラスタサイズ**: 20質問/グループ（調整可能）

### 3.2 質問の要約
- **手法**: Google Gemini APIを使用した自然言語処理
- **要約形式**: 
  - 代表的な質問文の生成
  - 共通する疑問点の抽出
  - 回答すべきポイントの整理

### 3.3 回答候補の生成
- **入力**: クラスタ化された質問群 + 講義資料（オプション）
- **出力**: 構造化された回答案
- **特徴**: 
  - 複数の観点からの回答
  - 参考資料へのリンク（可能な場合）
  - 追加説明の必要性の提示

## 4. データフロー

1. **質問収集**: Excelファイル（またはAPIで受信）
2. **前処理**: タイムスタンプ順にソート、重複除去
3. **クラスタリング**: 類似質問をグループ化
4. **要約生成**: 各クラスタから代表質問を生成
5. **回答生成**: Gemini APIで回答案を作成
6. **結果表示**: 講師用UIに表示

## 5. 技術スタック

### バックエンド
- Python 3.13
- Flask (Webフレームワーク)
- google-generativeai (Gemini API)
- scikit-learn (クラスタリング)
- pandas (データ処理)

### フロントエンド
- HTML5/CSS3
- JavaScript (Vanilla)
- Bootstrap 5 (UIフレームワーク)

### データ処理
- openpyxl (Excel読み込み)
- JSON (内部データ形式)

## 6. UI/UX設計

### 講師用画面
1. **質問一覧ビュー**
   - クラスタごとにグループ表示
   - 質問数、重要度の可視化
   - フィルタリング機能

2. **要約・回答ビュー**
   - クラスタ代表質問の表示
   - AI生成回答の表示・編集
   - 回答済みマーク機能

3. **統計ダッシュボード**
   - 質問数の推移
   - カテゴリ別分布
   - 回答率の表示

## 7. パフォーマンス目標

- **処理時間**: 100質問を10秒以内で処理
- **スケーラビリティ**: 1000質問まで対応可能
- **レスポンス**: UI操作は1秒以内に反応

## 8. 拡張性への配慮

1. **質問数の増加対応**
   - バッチ処理の実装
   - 非同期処理の導入（将来的に）

2. **機能追加の容易性**
   - モジュール化された設計
   - APIベースのアーキテクチャ

3. **多言語対応**
   - 国際化対応の基盤準備

## 9. セキュリティ考慮事項

- API キーの環境変数管理
- 入力データのサニタイゼーション
- CORS設定の適切な管理